package app.pen.tester;
import static app.pen.tester.PenPopulator.populatepenMap;
import static app.pen.validations.PenInvalidUtils.validateId;
import static app.pen.validations.PenValidations.validateAll;

import java.time.LocalDate;
import java.util.Map;
import java.util.Scanner;
import java.util.stream.Collectors;

import app.pen.core.Pen;;
public class PenTester {

	public static void main(String[] args) {
		// TODO Auto-generated method stub
		Map<Integer,Pen> penMap = populatepenMap();
		int userChoice;
		boolean exitFlag=false;
		try (Scanner sc = new Scanner(System.in)){
			while(!exitFlag) {
				try {
					System.out.println("Welcome to AAA Pen Shop");
					System.out.println("Select from below:");
					userChoice=sc.nextInt();
					switch(userChoice) {
					case 1://Add a pen
						/*
						 * (Color penColor, Material penMaterial, Brand brand, int qtyAvailable, 
						 * LocalDate stockListingDate,LocalDate stockUpdateDate, double price)
						 * */
						System.out.println("Enter penColor, penMaterial, brand, qtyAvailable,stockListingDate,stockUpdateDate price");
						penMap.put(Pen.getPenIdGenerator()+1,validateAll(sc.next(),sc.next(),sc.next(),sc.nextInt(),sc.next(),sc.next(),sc.nextDouble()));
						System.out.println("Pen added successfully! Details:\n" + penMap.get(penMap.size()-1));
						break;
					case 2://Update stock
						System.out.println("Enter penId");
						validateId(sc.nextInt());
						//penMap.get(sc).
						break;
					case 3:
						LocalDate today = LocalDate.now();
						
						break;
					case 4:
						today = LocalDate.now();
						penMap=penMap.values()
								.stream()
								.filter(p->p.getStockUpdateDate().isAfter(today.minusMonths(9)))
								.collect(Collectors.toMap(p->p.getPenId(), p->p));
						break;
					case 5: 
						penMap.values().stream().forEach(p->System.out.println(p));
						break;
					case 0:
						exitFlag=true;
						System.out.println("Exiting program");
						break;
					}
				}catch(Exception e) {
					e.printStackTrace();
				}
			}
		}
	}

}
